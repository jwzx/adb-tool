import{i as e}from"./main-c6da19cc.js";import{i as s}from"./ipcRenderer-5e19eaee.js";import{s as a}from"./store2-21459949.js";import{_ as t,r as i,o as l,b as n,g as o,a as d,w as r,e as c,c as u,F as m,d as h,t as f,n as p,p as g,f as v}from"./index-503d693c.js";const _={data:()=>({action_url:"",image_info:[],num:0,servicAddress:"",dir_path:"",file_name:"",isCustom:"0",fileIndex:0,screenPics:[],connectInfo:"",isNext:!0,isInit:!1,command:""}),mounted(){this.getHost(),this.init()},computed:{isDisabled:function(){let e=!("1"==this.isCustom);return this.isInit&&this.setVal("isCustom",this.isCustom),e}},methods:{setVal(e,s){try{sessionStorage.setItem(e,s)}catch(a){this.$message.error(a.message)}},getVal(e){let s="";try{s=sessionStorage.getItem(e)}catch(a){}return s},init(){let e=this,s=this.getVal("screenPics"),a=this.getVal("dirPath"),t=this.getVal("isCustom"),i=this.getVal("fileIndex"),l=this.getVal("fileName");if(i&&(this.fileIndex=+i),t&&(this.isCustom=t),"1"==t&&(this.file_name=l),s)try{s=JSON.parse(s),e.screenPics=[].concat(s)}catch(n){}a&&(e.dir_path=a),this.isInit=!0,this.adbConnect("command","devices","",(function(s){var a;((null==(a=null==s?void 0:s.result)?void 0:a.result)||"").split(/\r\n/).filter((e=>{if(e.match(/device$/))return e.split(/\t+/)[0]})).length?e.isNext=!0:(e.$message.warn("adb未连接,请连接adb"),e.isNext=!1)}))},handleInput(e){this[e.target.name]=e.target.value,this.setVal("fileName",e.target.value),this.$forceUpdate()},scrrenFun(e,s){var a=this;let t="";if(!this.isNext&&!s)return;let i=`${this.file_name?this.file_name:""}${this.fileIndex}.png`;t=`shell screencap -p /sdcard/${i}`,this.dir_path?(s&&(t=`pull /sdcard/${i} ${this.dir_path}`),this.adbConnect(e,t,s,(function(e){s?(a.isNext=!0,a.fileIndex++,a.screenPics.push({img:`${a.dir_path}\\${i}`,title:i}),a.setVal("screenPics",JSON.stringify(a.screenPics)),a.setVal("fileIndex",a.fileIndex)):a.scrrenFun("command",!0)}))):this.$message.warn("请设置保存文件夹")},adbConnect(a,t,i,l){var n=this;if(!this.isNext&&!i)return void this.$message.warn("adb未连接或者程序还在进行中...");this.isNext=!1;let o={};if("command"===a)o={action:a,command:t||this.command.replace(/adb/,"")};else o={action:a};s.invoke(e.adbConnect,o).then((e=>{n.connectInfo=e.result.title+"\n"+e.result.result+"\n"+this.connectInfo,l&&l(e)}))},getHost(){s.invoke(e.checkHttpServer,{}).then((s=>{if(s.enable){this.servicAddress=s.server,a.set("httpServiceConfig",s);const t=s.server||"http://localhost:7071";let i=e.uploadFile.split(".").join("/");this.action_url=t+"/"+i}}))},openDirectry(a){s.invoke(e.openDirectory,{id:a}).then((e=>{}))},selectDir(){s.invoke(e.selectFolder,"").then((e=>{this.setVal("dirPath",e),this.dir_path=e,this.$message.info(e)}))},messageShow(){s.invoke(e.messageShow,"").then((e=>{this.$message.info(e)}))},messageShowConfirm(){s.invoke(e.messageShowConfirm,"").then((e=>{this.$message.info(e)}))},handleFileChange(e){if(console.log("handleFileChange-----"),""==this.action_url)return void this.$message.error("http服务未开启");const s=e.file.status;if("uploading"!==s&&console.log(e.file),"done"===s){const s=e.file.response;if(console.log("uploadRes:",s),"success"!==s.code)return this.$message.error(`file upload failed ${s.code} .`),!1;this.num++;const a=s.data;a.id=this.num,a.imageUrlText="image url",this.image_info.push(a),this.$message.success(`${e.file.name} file uploaded successfully.`)}else"error"===s&&this.$message.error(`${e.file.name} file upload failed.`)}}},b=e=>(g("data-v-657fd8e1"),e=e(),v(),e),k={id:"app-base-file"},C=b((()=>o("div",{class:"one-block-1"},[o("span",null," 1. 自定义指令 ")],-1))),$={class:"one-block-2"},I=b((()=>o("div",{class:"one-block-1"},[o("span",null," 2. 设置基础信息 ")],-1))),x={class:"one-block-2"},V=b((()=>o("div",{class:"one-block-1"},[o("span",null," 3、截屏 ")],-1))),w={class:"one-block-2"},y=b((()=>o("div",{class:"one-block-1"},[o("span",null," 4. 连接日志 ")],-1))),N={class:"one-block-2"};const P=t(_,[["render",function(e,s,a,t,g,v){const _=i("a-input"),b=i("a-col"),P=i("a-button"),S=i("a-row"),D=i("a-radio"),F=i("a-radio-group"),U=i("a-image"),j=i("a-card-meta"),H=i("a-card"),A=i("a-flex"),J=i("a-textarea");return l(),n("div",k,[C,o("div",$,[d(S,null,{default:r((()=>[d(b,{span:20},{default:r((()=>[d(_,{modelValue:g.command,"onUpdate:modelValue":s[0]||(s[0]=e=>g.command=e),modelModifiers:{value:!0},value:g.command,name:"command",placeholder:"shell pm list packages -3 ",onInput:s[1]||(s[1]=e=>v.handleInput(e)),"addon-before":"指令"},null,8,["modelValue","value"])])),_:1}),d(b,{span:4},{default:r((()=>[d(P,{onClick:s[2]||(s[2]=e=>v.adbConnect("command"))},{default:r((()=>[c(" 执行 ")])),_:1})])),_:1})])),_:1})]),I,o("div",x,[d(S,null,{default:r((()=>[d(b,{span:12},{default:r((()=>[d(_,{modelValue:g.dir_path,"onUpdate:modelValue":s[3]||(s[3]=e=>g.dir_path=e),value:g.dir_path,"addon-before":"保存目录"},null,8,["modelValue","value"])])),_:1}),d(b,{span:12},{default:r((()=>[d(P,{onClick:v.selectDir},{default:r((()=>[c(" 设置目录 ")])),_:1},8,["onClick"]),d(P,{onClick:s[4]||(s[4]=e=>v.openDirectry(g.dir_path))},{default:r((()=>[c(" 打开目录 ")])),_:1})])),_:1})])),_:1}),d(S,null,{default:r((()=>[d(b,{span:12},{default:r((()=>[d(_,{modelValue:g.file_name,"onUpdate:modelValue":s[5]||(s[5]=e=>g.file_name=e),modelModifiers:{value:!0},name:"file_name",onInput:s[6]||(s[6]=e=>v.handleInput(e)),disabled:v.isDisabled,value:g.file_name,"addon-before":"自定义文件名"},null,8,["modelValue","disabled","value"])])),_:1}),d(b,{span:5},{default:r((()=>[d(F,{value:g.isCustom,"onUpdate:value":s[7]||(s[7]=e=>g.isCustom=e),name:"radioGroup"},{default:r((()=>[d(D,{value:"1"},{default:r((()=>[c("是")])),_:1}),d(D,{value:"0"},{default:r((()=>[c("否")])),_:1})])),_:1},8,["value"])])),_:1})])),_:1})]),V,o("div",w,[d(S,null,{default:r((()=>[d(b,{span:24},{default:r((()=>[d(P,{onClick:s[8]||(s[8]=e=>v.scrrenFun("command"))},{default:r((()=>[c(" 截屏 ")])),_:1}),d(P,{onClick:s[9]||(s[9]=e=>v.openDirectry(g.dir_path))},{default:r((()=>[c(" 打开目录 ")])),_:1})])),_:1})])),_:1}),g.screenPics.length?(l(),u(A,{key:0,wrap:"wrap",gap:"small",class:"flex"},{default:r((()=>[(l(!0),n(m,null,h(g.screenPics,((e,s)=>(l(),u(H,{hoverable:"",style:{width:"200px"},key:s},{cover:r((()=>[d(U,{width:200,src:e.img,alt:e.img},null,8,["src","alt"])])),default:r((()=>[d(j,{title:e.title},{description:r((()=>[c(f(e.img),1)])),_:2},1032,["title"])])),_:2},1024)))),128))])),_:1})):p("",!0)]),y,o("div",N,[d(S,null,{default:r((()=>[d(b,{span:24},{default:r((()=>[d(J,{value:g.connectInfo,rows:5,placeholder:"连接结果"},null,8,["value"])])),_:1})])),_:1})])])}],["__scopeId","data-v-657fd8e1"]]);export{P as default};
